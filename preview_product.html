<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Preview Produk - Nama Produk</title>
    <!-- favicon -->
    <link rel="icon" href="image/icon.JPG" type="image/png" />
    <link rel="stylesheet" href="css/styles.css" />
    <!-- Swiper CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
    />
    <!-- Material Icon -->
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <!-- AOS JS Fade Up/Fade Down -->
    <link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet" />
  </head>

  <!-- Preloader -->
  <div
    id="preloader"
    class="fixed inset-0 bg-white z-50 flex items-center justify-center transition-opacity duration-500"
  >
    <div
      class="w-10 h-10 border-4 border-gray-200 border-t-[#d1a86f] rounded-full animate-spin"
    ></div>
  </div>

  <body class="bg-white text-white">
    <!-- Navbar Top -->
    <nav
      class="fixed top-0 left-0 w-full h-12 px-4 md:px-10 py-3 border-b border-[#d1a86f] shadow-sm flex items-center justify-between bg-[#0f2d25] z-[1000]"
      data-aos="fade-down"
      data-aos-duration="400"
      data-aos-delay="0"
    >
      <!-- Left: Logo -->
      <a href="index.html" class="flex items-center space-x-2 z-[1001]">
        <img src="image/icon.JPG" alt="Logo" class="w-8 h-8 object-contain" />
        <span
          class="text-md font-quantify font-extrabold tracking-wide text-[#d1a86f]"
        >
          SKAWAN INDUSTRIES
        </span>
      </a>

      <!-- Right: User Info with Dropdown -->
      <div class="flex items-center space-x-2 sm:space-x-3 relative z-[1000]">
        <!-- Username -->
        <span
          class="text-sm sm:text-md font-quantify font-extrabold tracking-wide text-white truncate max-w-[100px] sm:max-w-none"
        >
          USERNAME
        </span>
        <div class="relative">
          <!-- Avatar Button -->
          <button
            id="profile-menu-btn"
            class="w-9 h-9 sm:w-10 sm:h-10 rounded-full border-2 border-[#d1a86f] overflow-hidden focus:outline-none"
          >
            <img
              src="image/usericon.jpg"
              alt="User Profile"
              class="w-full h-full object-cover cursor-pointer"
            />
          </button>

          <!-- Dropdown -->
          <div
            id="profile-menu-dropdown"
            class="hidden absolute right-0 top-full mt-3 w-52 bg-white rounded-lg shadow-xl ring-1 ring-gray-200 z-[1001]"
          >
            <a
              href="user_profile.html"
              class="flex items-center gap-3 px-4 py-3 text-sm text-gray-800 hover:bg-gray-100 transition"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-4 w-4 text-gray-600"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 20h9"
                />
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M16 4H8m8 0v16M8 4v16"
                />
              </svg>
              Edit Profil
            </a>
            <a
              href="logout.html"
              class="flex items-center gap-3 px-4 py-3 text-sm text-red-600 hover:bg-red-50 transition"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-4 w-4 text-red-500"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M17 16l4-4m0 0l-4-4m4 4H7"
                />
              </svg>
              Logout
            </a>
          </div>

          <!-- SCRIPT -->
          <script>
            document.addEventListener("DOMContentLoaded", function () {
              const profileBtn = document.getElementById("profile-menu-btn");
              const dropdown = document.getElementById("profile-menu-dropdown");

              profileBtn.addEventListener("click", function (e) {
                e.stopPropagation();
                dropdown.classList.toggle("hidden");
              });

              document.addEventListener("click", function (e) {
                if (
                  !dropdown.contains(e.target) &&
                  !profileBtn.contains(e.target)
                ) {
                  dropdown.classList.add("hidden");
                }
              });
            });
          </script>
        </div>
      </div>
    </nav>

    <!-- Product Info Bar -->
    <div
      class="fixed top-12 w-full z-[999] bg-white border-b border-gray-200 shadow-sm px-4 md:px-10 pt-4 pb-8 sm:py-4 flex items-start sm:items-center justify-between"
      data-aos="fade-down"
      data-aos-duration="400"
      data-aos-delay="100"
    >
      <!-- Kiri: Tombol Back -->
      <div class="flex-shrink-0 mt-1 sm:mt-0">
        <a
          href="design_product.html"
          class="font-quantify inline-flex items-center text-sm sm:text-sm text-gray-600 hover:text-black font-medium transition"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-5 w-5 mr-1"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M15 19l-7-7 7-7"
            />
          </svg>
          Kembali
        </a>
      </div>

      <!-- Tengah: Nama Produk dan Harga -->
      <div class="absolute left-1/2 transform -translate-x-1/2 text-center">
        <h1 class="text-base sm:text-lg font-quantify font-bold text-[#0f2d25]">
          Nama Produk Kaos
        </h1>
        <span
          class="text-sm sm:text-base font-quantify font-semibold text-[#0f2d25]"
        >
          Total Harga : Rp 125.000
        </span>
      </div>
    </div>

    <!-- SECTION PREVIEW PRODUK -->
    <div
      class="relative overflow-visible z-0 flex flex-col lg:flex-row gap-6 mt-40 px-4 mb-5"
    >
      <!-- preview product -->
      <div
        class="flex-1 relative z-0 flex justify-center items-center px-4 sm:px-0 border border-black rounded-2xl shadow-xl p-4 sm:p-6 bg-white"
      >
        <div class="w-full max-w-[500px] space-y-4 flex flex-col items-center">
          <div
            id="canvas-wrapper"
            class="bg-white p-2 sm:p-4 flex justify-center items-center relative overflow-hidden"
            style="
              width: 100%;
              padding-top: calc(100% * var(--canvas-aspect-ratio));
            "
          >
            <canvas
              id="previewCanvas"
              class="absolute top-0 left-0 w-full h-full"
            ></canvas>
          </div>

          <div
            class="bg-white border border-gray-300 rounded-xl shadow-md px-2.5 sm:px-4 py-2 sm:py-3 flex flex-wrap justify-center items-center gap-1.5 sm:gap-2 w-full max-w-[320px] sm:max-w-[560px] z-30"
          >
            <div class="flex items-center gap-1 sm:gap-2 flex-shrink-0">
              <span class="text-[10px] sm:text-sm text-gray-700 font-medium"
                >Zoom :</span
              >
              <select
                id="zoomSelect"
                class="appearance-none bg-white border border-gray-300 text-gray-800 text-[10px] sm:text-sm px-1.5 sm:px-3 py-0.5 sm:py-1.5 rounded focus:outline-none cursor-pointer h-6 sm:h-8"
              >
                <option value="50">50%</option>
                <option value="75">75%</option>
                <option value="100" selected>100%</option>
                <option value="125">125%</option>
                <option value="150">150%</option>
              </select>
            </div>
            <button
              id="depanButton"
              class="flex-shrink-0 flex items-center gap-1 sm:gap-2 bg-white border border-gray-300 hover:bg-gray-100 text-gray-800 text-[10px] sm:text-sm px-1.5 sm:px-3 py-0.5 sm:py-1.5 rounded transition h-6 sm:h-8"
            >
              <svg
                class="w-3.5 h-3.5 sm:w-5 sm:h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 19l-7-7 7-7"
                />
              </svg>
              Depan
            </button>
            <button
              id="belakangButton"
              class="flex-shrink-0 flex items-center gap-1 sm:gap-2 bg-white border border-gray-300 hover:bg-gray-100 text-gray-800 text-[10px] sm:text-sm px-1.5 sm:px-3 py-0.5 sm:py-1.5 rounded transition h-6 sm:h-8"
            >
              <svg
                class="w-3.5 h-3.5 sm:w-5 sm:h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 5l7 7-7 7"
                />
              </svg>
              Belakang
            </button>
            <a
              href="design_product.html"
              class="flex-shrink-0 flex items-center gap-1 sm:gap-2 bg-white border border-gray-300 hover:bg-gray-100 text-gray-800 text-[10px] sm:text-sm px-1.5 sm:px-3 py-0.5 sm:py-1.5 rounded transition h-6 sm:h-8"
            >
              <svg
                class="w-3.5 h-3.5 sm:w-5 sm:h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5M18.5 2.5a2.121 2.121 0 113 3L12 15l-4 1 1-4 9.5-9.5z"
                />
              </svg>
              Edit
            </a>
          </div>
        </div>
      </div>

      <!-- === Tombol Aksi Mobile (Hanya muncul di mobile) === -->
      <div class="sm:hidden mt-6 px-4 w-full">
        <div class="flex flex-col gap-3 w-full">
          <a
            href="#"
            class="w-full flex items-center justify-center gap-2 text-sm font-quantify px-4 py-3 border border-[#d1a86f] text-[#0f2d25] bg-[#d1a86f] rounded-xl hover:bg-[#c1985e] transition"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-5 w-5"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M7 10l5 5m0 0l5-5m-5 5V4"
              />
            </svg>
            Download
          </a>
        </div>
      </div>

      <!-- informasi produk section -->
      <div
        class="w-full lg:w-80 flex-none bg-white border border-[#d1a86f] p-4 rounded-2xl shadow-xl mt-2 lg:mt-0"
      >
        <h2
          class="text-xl font-bold text-[#0f2d25] mb-6 font-quantify text-center"
        >
          Informasi Desain Produk
        </h2>

        <div class="space-y-5 text-[15px] text-gray-800">
          <div class="flex items-start gap-3 border-b border-gray-200 pb-3">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="w-5 h-5 mt-0.5 text-[#d1a86f]"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="1.5"
                d="M9 12h6m-6 4h6m-6-8h6"
              />
            </svg>
            <div class="flex flex-col w-full">
              <span class="text-gray-500">Nama Produk</span>
              <span class="font-semibold text-[#0f2d25] text-[16px]"
                >Kaos Premium</span
              >
            </div>
          </div>

          <div class="flex items-start gap-3 border-b border-gray-200 pb-3">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="w-5 h-5 mt-0.5 text-[#d1a86f]"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="1.5"
                d="M4 6h16M4 10h16M4 14h16M4 18h16"
              />
            </svg>
            <div class="flex flex-col w-full">
              <span class="text-gray-500">Kategori</span>
              <span class="font-semibold text-[#0f2d25] text-[16px]"
                >T-Shirt</span
              >
            </div>
          </div>

          <div class="flex items-start gap-3 border-b border-gray-200 pb-3">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="w-5 h-5 mt-0.5 text-[#d1a86f]"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="1.5"
                d="M15 12h.01M12 12h.01M9 12h.01M3 16h18M4 8h16M6 4h12"
              />
            </svg>
            <div class="flex flex-col w-full">
              <span class="text-gray-500">Link Produk</span>
              <a
                href="#"
                class="text-blue-600 hover:underline text-sm truncate max-w-full"
                title="https://skawan.com/produk/kaos-premium"
              >
                skawan.com/produk/kaos-premium
              </a>
            </div>
          </div>

          <div class="flex items-start gap-3 border-b border-gray-200 pb-3">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="w-5 h-5 mt-0.5 text-[#d1a86f]"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="1.5"
                d="M8 7V3m8 4V3M5 11h14M5 19h14M5 15h14"
              />
            </svg>
            <div class="flex flex-col w-full">
              <span class="text-gray-500">Tanggal Pengajuan</span>
              <span class="font-semibold text-[#0f2d25] text-[16px]"
                >06 Juli 2025</span
              >
            </div>
          </div>

          <div class="flex items-start gap-3 border-b border-gray-200 pb-3">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="w-5 h-5 mt-0.5 text-[#d1a86f]"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="1.5"
                d="M4 6h16M4 10h16M4 14h16"
              />
            </svg>
            <div class="flex flex-col w-full">
              <span class="text-gray-500">Ukuran & Jumlah</span>
              <ul
                class="list-disc list-inside text-gray-700 space-y-0.5 mt-1 text-[15px]"
              >
                <li>M - 2 pcs</li>
                <li>L - 3 pcs</li>
                <li>2XL - 1 pcs</li>
              </ul>
            </div>
          </div>

          <div class="flex items-start gap-3 pt-2">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="w-5 h-5 mt-0.5 text-[#d1a86f]"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="1.5"
                d="M12 8c-2 0-4 2-4 4s2 4 4 4 4-2 4-4-2-4-4-4zm0 10c-4.418 0-8-1.79-8-4V5a1 1 0 011-1h14a1 1 0 011 1v9c0 2.21-3.582 4-8 4z"
              />
            </svg>
            <div class="flex justify-between items-center w-full">
              <span class="font-semibold text-[#0f2d25] text-[16px]"
                >Total Harga</span
              >
              <span class="font-bold text-[#0f2d25] text-[17px]"
                >Rp 125.000</span
              >
            </div>
          </div>
        </div>

        <!-- button section -->
        <div class="mt-20 text-center">
          <div class="flex flex-col items-center justify-center space-y-4">
            <button
              id="downloadImageButton"
              class="inline-flex items-center justify-center gap-2 px-6 py-3 rounded-lg bg-yellow-400 text-black font-medium hover:bg-yellow-500 transition text-[15px] w-full max-w-xs"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"
                />
              </svg>
              Unduh Gambar
            </button>
            <button
              class="inline-flex items-center justify-center gap-2 px-6 py-3 rounded-lg bg-green-600 text-white font-medium hover:bg-green-700 transition text-[15px] w-full max-w-xs"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M6 9V2h12v7M6 18h12v2a1 1 0 01-1 1H7a1 1 0 01-1-1v-2zm12 0H6v-4h12v4z"
                />
              </svg>
              Checkout Produk
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer Section -->
    <footer class="w-full bg-[#0f2d25] text-white mt-10">
      <div
        class="max-w-[1500px] mx-auto px-4 sm:px-6 md:px-12 lg:px-20 xl:px-24 py-12"
      >
        <!-- Top Section -->
        <div
          class="flex flex-col md:flex-row justify-between items-center pb-8 mb-8 border-b border-[#15453a]"
        >
          <!-- Logo and Tagline -->
          <div
            class="flex flex-col md:items-start items-center text-center md:text-left mb-4 md:mb-0"
          >
            <div class="flex items-center mb-2">
              <img
                src="image/icon.JPG"
                alt="SKAWAN INDUSTRIES Logo"
                class="w-10 h-10 rounded-full mr-3"
              />
              <h3
                class="font-quantify text-xl sm:text-2xl font-bold text-[#d1a86f]"
              >
                SKAWAN INDUSTRIES
              </h3>
            </div>
            <h6 class="text-sm text-white font-quantify">
              Start order now and get a cool design product
            </h6>
          </div>
        </div>

        <!-- Grid Section -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
          <!-- Alamat -->
          <div class="flex flex-col items-start text-left">
            <h4 class="font-bold text-lg text-white font-quantify">Alamat</h4>
            <div class="w-12 h-1 bg-white mt-1 mb-4"></div>
            <p class="text-white mb-4 font-quantify">
              Jl. Puri Airlangga No.20 blok P, Kapasan, Sidokare, Sidoarjo,
              Sidoarjo Regency, East Java 61214
            </p>
            <div
              class="w-full h-[280px] md:h-[320px] rounded-lg overflow-hidden"
            >
              <iframe
                src="https://www.google.com/maps?q=-7.446144,112.707078&hl=es;z=14&output=embed"
                width="100%"
                height="100%"
                style="border: 0"
                allowfullscreen=""
                loading="lazy"
                referrerpolicy="no-referrer-when-downgrade"
                class="w-full h-full filter grayscale contrast-110"
              >
              </iframe>
            </div>
          </div>

          <!-- Follow Us On -->
          <div class="flex flex-col items-start text-left">
            <h4 class="font-bold text-lg text-white font-quantify">
              Follow Us On :
            </h4>
            <div class="w-12 h-1 bg-white mt-1 mb-4"></div>
            <div class="flex flex-col space-y-4">
              <!-- WhatsApp -->
              <a
                href="https://wa.me/6289649710370"
                target="_blank"
                class="flex items-center space-x-3 group"
              >
                <div
                  class="w-10 h-10 flex items-center justify-center rounded-full bg-white/10 group-hover:bg-white/20 transition"
                >
                  <img
                    src="image/whatsapp_icon.png"
                    alt="WhatsApp"
                    class="w-5 h-5"
                  />
                </div>
                <span class="text-white font-quantify">WhatsApp</span>
              </a>

              <!-- Instagram -->
              <a
                href="https://www.instagram.com/skawanindustries?igsh=MzJqMWdwb294Mnk4"
                target="_blank"
                class="flex items-center space-x-3 group"
              >
                <div
                  class="w-10 h-10 flex items-center justify-center rounded-full bg-white/10 group-hover:bg-white/20 transition"
                >
                  <img
                    src="image/instagram_icon.png"
                    alt="Instagram"
                    class="w-5 h-5"
                  />
                </div>
                <span class="text-white font-quantify">Instagram</span>
              </a>

              <!-- Shopee -->
              <a
                href="http://shopee.co.id/skawanindustries"
                target="_blank"
                class="flex items-center space-x-3 group"
              >
                <div
                  class="w-10 h-10 flex items-center justify-center rounded-full bg-white/10 group-hover:bg-white/20 transition"
                >
                  <img
                    src="image/shopee_icon.png"
                    alt="Shopee"
                    class="w-5 h-5"
                  />
                </div>
                <span class="text-white font-quantify">Shopee</span>
              </a>
            </div>
          </div>

          <!-- Get In Touch -->
          <div class="flex flex-col items-start text-left">
            <h4 class="font-bold text-lg text-white font-quantify">
              Get In Touch With Us
            </h4>
            <div class="w-12 h-1 bg-white mt-1 mb-4"></div>
            <p class="text-white font-quantify">Phone: +62 8819 727 687</p>
            <p class="text-white mt-4 font-quantify">
              Senin–Jumat:<br />9.00 – 20.00
            </p>
            <p class="text-white mt-4 font-quantify">
              Saturday-Minggu:<br />10.00 – 17.00
            </p>
            <p class="text-white mt-4 font-quantify">
              support@skawanindustries.com
            </p>
          </div>

          <!-- Quick Links -->
          <div class="flex flex-col items-start text-left">
            <h4 class="font-bold text-lg text-white font-quantify">
              Quick Links
            </h4>
            <div class="w-12 h-1 bg-white mt-1 mb-4"></div>
            <ul class="space-y-2">
              <li>
                <a
                  href="index.html"
                  class="text-white hover:text-green-300 font-quantify"
                  >Home Page</a
                >
              </li>
              <li>
                <a
                  href="list_product.html"
                  class="text-white hover:text-green-300 font-quantify"
                  >category1</a
                >
              </li>
              <li>
                <a
                  href="list_product.html"
                  class="text-white hover:text-green-300 font-quantify"
                  >category2</a
                >
              </li>
              <li>
                <a
                  href="list_product.html"
                  class="text-white hover:text-green-300 font-quantify"
                  >category3</a
                >
              </li>
              <li>
                <a
                  href="list_product.html"
                  class="text-white hover:text-green-300 font-quantify"
                  >category4</a
                >
              </li>
              <li>
                <a
                  href="list_product.html"
                  class="text-white hover:text-green-300 font-quantify"
                  >category5</a
                >
              </li>
            </ul>
          </div>
        </div>

        <!-- Bottom Footer -->
        <div
          class="mt-12 pt-6 border-t border-[#15453a] flex flex-col md:flex-row justify-between items-center text-sm text-white gap-4"
        >
          <!-- Left: Follow Us On -->
          <div class="flex items-center space-x-4">
            <span class="font-quantify text-white">Follow Us On:</span>

            <!-- WhatsApp -->
            <a
              href="https://wa.me/6289649710370"
              target="_blank"
              class="hover:text-green-300 transition"
            >
              <img
                src="image/whatsapp_icon.png"
                alt="WhatsApp"
                class="w-5 h-5"
              />
            </a>

            <!-- Instagram -->
            <a
              href="https://www.instagram.com/skawanindustries?igsh=MzJqMWdwb294Mnk4"
              target="_blank"
              class="hover:text-green-300 transition"
            >
              <img
                src="image/instagram_icon.png"
                alt="Instagram"
                class="w-5 h-5"
              />
            </a>
          </div>

          <!-- Center: Copyright -->
          <p class="text-center w-full md:w-auto font-quantify">
            © 2025 SKAWAN INDUSTRIES. All rights reserved.
          </p>

          <!-- Right: Kosong -->
          <div class="w-[120px] h-5 hidden md:block"></div>
        </div>
      </div>
    </footer>

    <!-- swiper js -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <!-- AOS JS Fade Up/Fade Down -->
    <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
    <script>
      AOS.init();
    </script>
    <!-- tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- custom js -->
    <script src="js/script.js"></script>
    <!-- fabric js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js"></script>
    <script>
      // =====================================
      // KODE GABUNGAN UNTUK SEMUA FILE JAVASCRIPT
      // UNTUK HALAMAN preview_product.html
      // =====================================

      // --- preview-canvas-init.js ---
      let canvas;
      let currentZoom = 1;
      let currentSide = "front";
      let backgroundAsObject = null; // This will be the Fabric.js object for the background

      const productImages = {
        front: "image/product4.jpeg",
        back: "image/product1.jpeg",
      };

      // Inisialisasi savedDesigns dengan objek kosong untuk 'front' dan 'back'
      // Ini penting agar Object.assign bisa bekerja saat memuat data dari localStorage.
      const savedDesigns = {
        front: { objects: [], canvasWidth: 600, canvasHeight: 600 },
        back: { objects: [], canvasWidth: 600, canvasHeight: 600 },
        // Ini adalah dimensi referensi dari kanvas Design Product,
        // kita akan menggunakannya untuk penskalaan objek
        referenceWidth: 600, // Misal, lebar kanvas saat design dibuat
        referenceHeight: 600, // Misal, tinggi kanvas saat design dibuat
      };

      const localStorageKey = "kaosDesign";

      // Function to resize canvas and its contents
      const resizeCanvas = async () => {
        const canvasWrapper = document.getElementById("canvas-wrapper");
        if (!canvasWrapper) return;

        // Ambil lebar yang tersedia dari parent container (misal: max-w-[500px])
        const availableWidth = canvasWrapper.clientWidth;

        // Tentukan lebar kanvas preview berdasarkan lebar yang tersedia
        // Biarkan tinggi kanvas ditentukan berdasarkan aspek rasio gambar latar belakang
        const currentProductImage = productImages[currentSide];

        // Load image temporarily to get its dimensions
        const imgTemp = new Image();
        imgTemp.src = currentProductImage;
        await new Promise((resolve) => {
          imgTemp.onload = resolve;
          imgTemp.onerror = resolve; // Resolve even on error to prevent hanging
        });

        const originalImageWidth =
          imgTemp.naturalWidth || savedDesigns.referenceWidth;
        const originalImageHeight =
          imgTemp.naturalHeight || savedDesigns.referenceHeight;

        const imageAspectRatio = originalImageWidth / originalImageHeight;

        let newCanvasWidth = availableWidth;
        let newCanvasHeight = newCanvasWidth / imageAspectRatio;

        // Set Fabric.js canvas dimensions
        canvas.setDimensions({
          width: newCanvasWidth,
          height: newCanvasHeight,
        });

        // Update canvas wrapper style to match new canvas dimensions
        canvasWrapper.style.width = `${newCanvasWidth}px`;
        canvasWrapper.style.height = `${newCanvasHeight}px`;

        // Re-load and re-scale background image to fit new canvas size
        await loadBackgroundImage(currentSide, newCanvasWidth, newCanvasHeight);

        // Re-load and re-scale design objects
        await displayDesignObjectsOnly(currentSide); // Panggil fungsi baru untuk memuat objek saja

        updateCanvasZoom(); // Apply current zoom after resizing
        canvas.renderAll();
      };

      document.addEventListener("DOMContentLoaded", async function () {
        const canvasElement = document.getElementById("previewCanvas");
        const canvasWrapper = document.getElementById("canvas-wrapper");

        if (!canvasElement || !canvasWrapper) {
          console.error("Canvas or wrapper element not found.");
          return;
        }

        // Retrieve design from localStorage
        const savedFullDesign = localStorage.getItem(localStorageKey);
        if (savedFullDesign) {
          try {
            const parsedDesign = JSON.parse(savedFullDesign);

            // Ambil dimensi kanvas referensi dari desain yang disimpan
            if (
              parsedDesign.front &&
              parsedDesign.front.canvasWidth &&
              parsedDesign.front.canvasHeight
            ) {
              savedDesigns.referenceWidth = parsedDesign.front.canvasWidth;
              savedDesigns.referenceHeight = parsedDesign.front.canvasHeight;
            } else if (
              parsedDesign.back &&
              parsedDesign.back.canvasWidth &&
              parsedDesign.back.canvasHeight
            ) {
              // Fallback if only back design has dimensions
              savedDesigns.referenceWidth = parsedDesign.back.canvasWidth;
              savedDesigns.referenceHeight = parsedDesign.back.canvasHeight;
            }

            // Assign data to the initialized objects
            if (parsedDesign.front)
              Object.assign(savedDesigns.front, parsedDesign.front);
            if (parsedDesign.back)
              Object.assign(savedDesigns.back, parsedDesign.back);
          } catch (e) {
            console.error("Error parsing design from localStorage:", e);
            // Reset to default if parsing fails
            savedDesigns.front = {
              objects: [],
              canvasWidth: 600,
              canvasHeight: 600,
            };
            savedDesigns.back = {
              objects: [],
              canvasWidth: 600,
              canvasHeight: 600,
            };
          }
        }

        // Initialize Fabric.js canvas with the *reference* dimensions.
        // These are the dimensions relative to which objects were saved.
        // The actual display size will be handled by resizeCanvas.
        canvas = new fabric.Canvas("previewCanvas", {
          selection: false, // Disable box selection
          interactive: false, // Disable default Fabric.js object interaction
          preserveObjectStacking: true,
          renderOnAddRemove: false,
          backgroundColor: "transparent",
          width: savedDesigns.referenceWidth, // Initial internal rendering width
          height: savedDesigns.referenceHeight, // Initial internal rendering height
        });

        // Initial resize and display of the current side
        // Ini akan memanggil loadBackgroundImage dan displayDesignObjectsOnly
        await resizeCanvas();
        updateCanvasZoom(); // Apply current zoom after initial display

        // Initial button state (Depan should be active by default)
        const depanButton = document.getElementById("depanButton");
        if (depanButton) {
          depanButton.classList.add("bg-gray-200");
        }

        // Add resize listener to window
        window.addEventListener("resize", resizeCanvas);
      });

      // --- preview-design-display.js ---
      async function loadBackgroundImage(side, targetWidth, targetHeight) {
        const backgroundImageURL = productImages?.[side];
        if (!backgroundImageURL) {
          canvas.setBackgroundImage(null, canvas.renderAll.bind(canvas));
          backgroundAsObject = null;
          return;
        }

        backgroundAsObject = await new Promise((resolve, reject) => {
          fabric.Image.fromURL(
            backgroundImageURL,
            (img) => {
              if (!img) {
                console.warn(
                  "Background image failed to load:",
                  backgroundImageURL
                );
                return resolve(null);
              }

              const imgAspectRatio = img.width / img.height;
              const canvasAspectRatio = targetWidth / targetHeight;

              let scale;
              // Determine scale to fit the image entirely within the canvas while maintaining aspect ratio
              if (imgAspectRatio > canvasAspectRatio) {
                // Image is wider relative to canvas, scale by width
                scale = targetWidth / img.width;
              } else {
                // Image is taller relative to canvas, scale by height
                scale = targetHeight / img.height;
              }
              img.scale(scale);

              const centerX = (targetWidth - img.width * scale) / 2;
              const centerY = (targetHeight - img.height * scale) / 2;

              img.set({
                left: centerX,
                top: centerY,
                originX: "left",
                originY: "top",
                selectable: false,
                evented: false,
                hasControls: false,
                hasBorders: false,
                objectCaching: false,
              });
              resolve(img);
            },
            {
              crossOrigin: "anonymous",
              onError: (err) => {
                console.error(
                  "Failed to load background image with Fabric.js:",
                  backgroundImageURL,
                  err
                );
                resolve(null);
              },
            }
          );
        });

        if (backgroundAsObject) {
          canvas.setBackgroundImage(
            backgroundAsObject,
            canvas.renderAll.bind(canvas)
          );
          // Send background to back just in case
          canvas.sendToBack(backgroundAsObject);
        } else {
          canvas.setBackgroundImage(null, canvas.renderAll.bind(canvas));
        }
      }

      // New function to only display design objects (without clearing canvas or background)
      async function displayDesignObjectsOnly(side) {
        // Hapus hanya objek desain, jaga background
        canvas.remove(
          ...canvas.getObjects().filter((obj) => obj !== backgroundAsObject)
        );

        const designData = savedDesigns?.[side];
        const designObjectsData = designData ? designData.objects : [];
        // Use the reference dimensions from when the design was *saved*
        const savedDesignWidth = savedDesigns.referenceWidth;
        const savedDesignHeight = savedDesigns.referenceHeight;

        // Load fonts first
        if (designObjectsData && designObjectsData.length > 0) {
          const fontFamiliesToLoad = new Set();
          designObjectsData.forEach((obj) => {
            if (obj.type === "textbox" && obj.fontFamily) {
              fontFamiliesToLoad.add(obj.fontFamily);
            }
          });
          const fontLoadPromises = [];
          fontFamiliesToLoad.forEach((fontFamily) => {
            const fontUrl = `https://fonts.googleapis.com/css2?family=${fontFamily.replace(
              / /g,
              "+"
            )}&display=swap`;
            const linkId = `preview-font-link-${fontFamily.replace(
              /[^a-zA-Z0-9]/g,
              ""
            )}`;
            if (!document.getElementById(linkId)) {
              const link = document.createElement("link");
              link.id = linkId;
              link.rel = "stylesheet";
              link.href = fontUrl;
              document.head.appendChild(link);
            }
            fontLoadPromises.push(document.fonts.load(`16px "${fontFamily}"`));
          });
          await Promise.all(fontLoadPromises).catch((e) =>
            console.error("Error loading fonts:", e)
          );
        }

        // Load design objects using loadFromJSON
        if (designObjectsData && designObjectsData.length > 0) {
          // Calculate scaling factors from the saved design's canvas size to the *current actual* canvas size
          const currentCanvasWidth = canvas.getWidth();
          const currentCanvasHeight = canvas.getHeight();

          const scaleFactorX = currentCanvasWidth / savedDesignWidth;
          const scaleFactorY = currentCanvasHeight / savedDesignHeight;

          // Create a temporary JSON structure to load. Fabric.js's loadFromJSON expects a specific format.
          const fabricJSONFormat = {
            objects: designObjectsData,
          };

          await new Promise((resolve) => {
            canvas.loadFromJSON(
              fabricJSONFormat,
              () => {
                // Once objects are loaded, iterate and apply the scaling
                canvas.forEachObject((obj) => {
                  if (obj === backgroundAsObject) return; // Skip background

                  // Apply scaling to the object properties
                  // PENTING: Lakukan scaling terhadap posisi relatif dari origin point objek.
                  // Fabric.js secara default menggunakan originX/Y 'left'/'top'.
                  // Jika ingin objek tetap di tengah, gunakan pendekatan ini.
                  obj.set({
                    originX: obj.originX || "left", // Preserve original originX/Y or set default
                    originY: obj.originY || "top", // Preserve original originX/Y or set default
                  });

                  const objCenterX = obj.left + obj.getScaledWidth() / 2;
                  const objCenterY = obj.top + obj.getScaledHeight() / 2;

                  obj.set({
                    left:
                      objCenterX * scaleFactorX -
                      (obj.getScaledWidth() * scaleFactorX) / 2,
                    top:
                      objCenterY * scaleFactorY -
                      (obj.getScaledHeight() * scaleFactorY) / 2,
                    scaleX: obj.scaleX * scaleFactorX,
                    scaleY: obj.scaleY * scaleFactorY,
                    selectable: false, // Ensure not selectable
                    evented: false, // Ensure not interactive
                    hasControls: false,
                    hasBorders: false,
                  });
                  // For textboxes, scale font size
                  if (obj.type === "textbox") {
                    obj.set("fontSize", obj.fontSize * scaleFactorY);
                    obj.initDimensions(); // Recalculate dimensions for scaled font
                  }
                  obj.setCoords(); // Update object's bounding box
                });

                if (backgroundAsObject) {
                  canvas.sendToBack(backgroundAsObject);
                }
                canvas.renderAll();
                resolve();
              },
              function (o, object) {
                // Progress function (optional, not scaling here)
              }
            );
          });
        } else {
          canvas.renderAll(); // Render even if no design objects
        }
      }

      async function displayDesign(side) {
        currentSide = side;
        canvas.clear(); // Clear all objects including background

        // Active/inactive buttons for view switching
        const depanButton = document.getElementById("depanButton");
        const belakangButton = document.getElementById("belakangButton");
        if (depanButton) {
          depanButton.classList.toggle("bg-gray-200", side === "front");
          depanButton.classList.toggle("bg-white", side !== "front");
        }
        if (belakangButton) {
          belakangButton.classList.toggle("bg-gray-200", side === "back");
          belakangButton.classList.toggle("bg-white", side !== "back");
        }

        // Re-adjust canvas size based on the new background image's aspect ratio
        // This is crucial for responsive layout and avoiding extra space
        await resizeCanvas(); // This now handles loading background and objects for the new side

        updateCanvasZoom(); // Apply current zoom after loading
        canvas.renderAll();
      }

      // --- panel-controls.js ---
      function setupPanelControls() {
        const zoomSelect = document.getElementById("zoomSelect");
        if (zoomSelect) {
          zoomSelect.addEventListener("change", function () {
            currentZoom = parseFloat(this.value) / 100;
            updateCanvasZoom();
          });
        }

        const depanButton = document.getElementById("depanButton");
        const belakangButton = document.getElementById("belakangButton");

        if (depanButton) {
          depanButton.addEventListener("click", () => {
            if (currentSide !== "front") displayDesign("front");
          });
        }

        if (belakangButton) {
          belakangButton.addEventListener("click", () => {
            if (currentSide !== "back") displayDesign("back");
          });
        }

        const downloadImageButton = document.getElementById(
          "downloadImageButton"
        );
        if (downloadImageButton) {
          downloadImageButton.addEventListener("click", () => {
            // Create a temporary canvas for high-res export
            const exportCanvasElement = document.createElement("canvas");
            const exportCanvas = new fabric.Canvas(exportCanvasElement, {
              backgroundColor: "transparent",
            });

            // Use a higher resolution for export, e.g., 1000px width
            const EXPORT_WIDTH = 1000;
            let EXPORT_HEIGHT = EXPORT_WIDTH; // Default to square

            // Get saved design data for the current side
            const designData = savedDesigns[currentSide];
            const designObjectsData = designData ? designData.objects : [];
            const savedDesignWidth = savedDesigns.referenceWidth;
            const savedDesignHeight = savedDesigns.referenceHeight;

            // Determine actual aspect ratio of the current product image for export
            const currentProductImage = productImages[currentSide];
            const imgTemp = new Image();
            imgTemp.src = currentProductImage;
            imgTemp.onload = async () => {
              const originalImageWidth = imgTemp.naturalWidth;
              const originalImageHeight = imgTemp.naturalHeight;
              const imageAspectRatio = originalImageWidth / originalImageHeight;
              EXPORT_HEIGHT = EXPORT_WIDTH / imageAspectRatio;

              exportCanvas.setDimensions({
                width: EXPORT_WIDTH,
                height: EXPORT_HEIGHT,
              });

              // Load background image for export canvas
              const exportBg = await new Promise((resolve) => {
                fabric.Image.fromURL(
                  currentProductImage,
                  (img) => {
                    if (!img) return resolve(null);

                    const imgAspect = img.width / img.height;
                    const exportCanvasAspect = EXPORT_WIDTH / EXPORT_HEIGHT;
                    let scale;
                    if (imgAspect > exportCanvasAspect) {
                      scale = EXPORT_HEIGHT / img.height;
                    } else {
                      scale = EXPORT_WIDTH / img.width;
                    }
                    img.scale(scale);
                    img.set({
                      left: (EXPORT_WIDTH - img.width * scale) / 2,
                      top: (EXPORT_HEIGHT - img.height * scale) / 2,
                      originX: "left",
                      originY: "top",
                      selectable: false,
                      evented: false,
                    });
                    resolve(img);
                  },
                  { crossOrigin: "anonymous" }
                );
              });

              if (exportBg) {
                exportCanvas.setBackgroundImage(
                  exportBg,
                  exportCanvas.renderAll.bind(exportCanvas)
                );
              }

              // Calculate scaling factors for objects
              const scaleFactorX = EXPORT_WIDTH / savedDesignWidth;
              const scaleFactorY = EXPORT_HEIGHT / savedDesignHeight;

              // Load and scale design objects to export canvas
              fabric.util.enlivenObjects(
                designObjectsData,
                function (enlivenedObjects) {
                  enlivenedObjects.forEach((obj) => {
                    // Apply originX/Y before scaling to maintain relative position
                    obj.set({
                      originX: obj.originX || "left",
                      originY: obj.originY || "top",
                    });

                    const objCenterX = obj.left + obj.getScaledWidth() / 2;
                    const objCenterY = obj.top + obj.getScaledHeight() / 2;

                    obj.set({
                      left:
                        objCenterX * scaleFactorX -
                        (obj.getScaledWidth() * scaleFactorX) / 2,
                      top:
                        objCenterY * scaleFactorY -
                        (obj.getScaledHeight() * scaleFactorY) / 2,
                      scaleX: obj.scaleX * scaleFactorX,
                      scaleY: obj.scaleY * scaleFactorY,
                      selectable: false,
                      evented: false,
                      hasControls: false,
                      hasBorders: false, // Ensure non-interactive
                    });
                    if (obj.type === "textbox") {
                      obj.set("fontSize", obj.fontSize * scaleFactorY);
                      obj.initDimensions(); // Recalculate dimensions for scaled font
                    }
                    exportCanvas.add(obj);
                  });
                  exportCanvas.renderAll();

                  // Generate image and download
                  const dataURL = exportCanvas.toDataURL({
                    format: "png",
                    multiplier: 1, // Multiplier already handled by EXPORT_WIDTH/HEIGHT
                  });

                  const link = document.createElement("a");
                  link.href = dataURL;
                  link.download = `Kaos_Design_${currentSide}.png`;
                  document.body.appendChild(link);
                  link.click();
                  document.body.removeChild(link);

                  exportCanvas.dispose(); // Clean up temporary canvas
                }
              );
            };
            imgTemp.onerror = () => {
              console.error(
                "Could not load image for export to determine aspect ratio."
              );
              alert(
                "Gagal memuat gambar produk untuk export. Silakan coba lagi."
              );
            };
          });
        }
      }

      function updateCanvasZoom() {
        if (!canvas) return; // Ensure canvas is initialized

        if (currentZoom !== 1) {
          const centerPoint = new fabric.Point(
            canvas.getWidth() / 2,
            canvas.getHeight() / 2
          );
          canvas.zoomToPoint(centerPoint, currentZoom);
        } else {
          canvas.setZoom(1);
          canvas.setViewportTransform([1, 0, 0, 1, 0, 0]); // Reset pan to center
        }
        canvas.renderAll();
      }

      // --- preview-canvas-interaction.js ---
      let isDragging = false;
      let lastPosX;
      let lastPosY;

      document.addEventListener("DOMContentLoaded", function () {
        // IMPORTANT: Initialize pan events here, after canvas is created.
        // Ensure canvas is defined before attaching events
        // This will be called after `canvas` is available from preview-canvas-init.js
        if (canvas) {
          canvas.on("mouse:down", function (opt) {
            // Only enable pan if zoom is more than 100%
            if (canvas.getZoom() > 1.0) {
              isDragging = true;
              canvas.selection = false; // Ensure no box selection
              lastPosX = opt.e.clientX;
              lastPosY = opt.e.clientY;
              canvas.setCursor("grab"); // Change cursor
            }
          });

          canvas.on("mouse:move", function (opt) {
            if (isDragging) {
              const evt = opt.e;
              const vpt = this.viewportTransform;
              vpt[4] += evt.clientX - lastPosX;
              vpt[5] += evt.clientY - lastPosY;
              this.requestRenderAll(); // Use requestRenderAll for better performance
              lastPosX = evt.clientX;
              lastPosY = evt.clientY;
              canvas.setCursor("grabbing"); // Change cursor while dragging
            }
          });

          canvas.on("mouse:up", function (opt) {
            isDragging = false;
            canvas.selection = false; // Keep selection off, as interactive is false
            canvas.setCursor("default"); // Restore cursor
          });
        } else {
          console.warn("Canvas not initialized for pan controls.");
        }
      });

      // --- event-listeners.js ---
      document.addEventListener("DOMContentLoaded", async function () {
        // Made async to allow await
        const savedFullDesign = localStorage.getItem(localStorageKey); // Use localStorageKey

        // Initial call to resize and display first, without waiting for localStorage
        // This ensures canvas is set up and responsive immediately.
        await resizeCanvas(); // This also calls loadBackgroundImage and displayDesignObjectsOnly

        if (savedFullDesign) {
          try {
            const parsedDesign = JSON.parse(savedFullDesign);
            // Ensure properties exist before assigning
            if (parsedDesign.front) {
              Object.assign(savedDesigns.front, parsedDesign.front);
            }
            if (parsedDesign.back) {
              Object.assign(savedDesigns.back, parsedDesign.back);
            }
            // Update reference dimensions from parsed design
            if (parsedDesign.front && parsedDesign.front.canvasWidth) {
              savedDesigns.referenceWidth = parsedDesign.front.canvasWidth;
              savedDesigns.referenceHeight = parsedDesign.front.canvasHeight;
            } else if (parsedDesign.back && parsedDesign.back.canvasWidth) {
              savedDesigns.referenceWidth = parsedDesign.back.canvasWidth;
              savedDesigns.referenceHeight = parsedDesign.back.canvasHeight;
            }

            // Reload the current side's design data, which now has the correct objects
            // resizeCanvas already loaded initial background and objects, this just loads the saved ones over.
            displayDesign(currentSide); // This will reload with saved data and update buttons
          } catch (e) {
            console.error("Error parsing saved design from localStorage:", e);
            // Reset design data if parsing fails to avoid errors
            savedDesigns.front = {
              objects: [],
              canvasWidth: 600,
              canvasHeight: 600,
            };
            savedDesigns.back = {
              objects: [],
              canvasWidth: 600,
              canvasHeight: 600,
            };
          }
        } else {
          console.log("No saved design found in localStorage.");
        }

        // Set default zoom to 100% after all other initializations
        const zoomSelect = document.getElementById("zoomSelect"); // Get element by ID
        if (zoomSelect) {
          zoomSelect.value = "100"; // Set the dropdown to 100%
          updateCanvasZoom(); // Apply the 100% zoom programmatically
        }

        // Setup panel controls (buttons, zoom select)
        setupPanelControls();

        canvas.renderAll();
      });

      // window.addEventListener("resize", resizeCanvas); // Already handled in preview-canvas-init.js DOMContentLoaded
    </script>
  </body>
</html>
