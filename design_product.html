<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Desain Produk - Nama Produk</title>
    <!-- favicon -->
    <link rel="icon" href="image/icon.JPG" type="image/png" />
    <link rel="stylesheet" href="css/styles.css" />
    <link rel="stylesheet" href="css/guideline.css" />
    <!-- Swiper CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
    />
    <!-- Material Icon -->
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <!-- AOS JS Fade Up/Fade Down -->
    <link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet" />
  </head>

  <!-- Preloader -->
  <div
    id="preloader"
    class="fixed inset-0 bg-white z-50 flex items-center justify-center transition-opacity duration-500"
  >
    <div
      class="w-10 h-10 border-4 border-gray-200 border-t-[#d1a86f] rounded-full animate-spin"
    ></div>
  </div>

  <body class="bg-white text-white">
    <!-- Navbar Top -->
    <nav
      class="fixed top-0 left-0 w-full h-12 px-4 md:px-10 py-3 border-b border-[#d1a86f] shadow-sm flex items-center justify-between bg-[#0f2d25] z-[1000]"
      data-aos="fade-down"
      data-aos-duration="400"
      data-aos-delay="0"
    >
      <!-- Left: Logo -->
      <a href="index.html" class="flex items-center space-x-2 z-[1001]">
        <img src="image/icon.JPG" alt="Logo" class="w-8 h-8 object-contain" />
        <span
          class="text-md font-quantify font-extrabold tracking-wide text-[#d1a86f]"
        >
          SKAWAN INDUSTRIES
        </span>
      </a>

      <!-- Right: User Info with Dropdown -->
      <div class="flex items-center space-x-2 sm:space-x-3 relative z-[1000]">
        <!-- Username -->
        <span
          class="text-sm sm:text-md font-quantify font-extrabold tracking-wide text-white truncate max-w-[100px] sm:max-w-none"
        >
          USERNAME
        </span>
        <div class="relative">
          <!-- Avatar Button -->
          <button
            id="profile-menu-btn"
            class="w-9 h-9 sm:w-10 sm:h-10 rounded-full border-2 border-[#d1a86f] overflow-hidden focus:outline-none"
          >
            <img
              src="image/usericon.jpg"
              alt="User Profile"
              class="w-full h-full object-cover cursor-pointer"
            />
          </button>

          <!-- Dropdown -->
          <div
            id="profile-menu-dropdown"
            class="hidden absolute right-0 top-full mt-3 w-52 bg-white rounded-lg shadow-xl ring-1 ring-gray-200 z-[1001]"
          >
            <a
              href="user_profile.html"
              class="flex items-center gap-3 px-4 py-3 text-sm text-gray-800 hover:bg-gray-100 transition"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-4 w-4 text-gray-600"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 20h9"
                />
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M16 4H8m8 0v16M8 4v16"
                />
              </svg>
              Edit Profil
            </a>
            <a
              href="logout.html"
              class="flex items-center gap-3 px-4 py-3 text-sm text-red-600 hover:bg-red-50 transition"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-4 w-4 text-red-500"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M17 16l4-4m0 0l-4-4m4 4H7"
                />
              </svg>
              Logout
            </a>
          </div>

          <!-- SCRIPT -->
          <script>
            document.addEventListener("DOMContentLoaded", function () {
              const profileBtn = document.getElementById("profile-menu-btn");
              const dropdown = document.getElementById("profile-menu-dropdown");

              profileBtn.addEventListener("click", function (e) {
                e.stopPropagation();
                dropdown.classList.toggle("hidden");
              });

              document.addEventListener("click", function (e) {
                if (
                  !dropdown.contains(e.target) &&
                  !profileBtn.contains(e.target)
                ) {
                  dropdown.classList.add("hidden");
                }
              });
            });
          </script>
        </div>
      </div>
    </nav>

    <!-- Product Info Bar -->
    <div
      class="fixed top-12 w-full z-[999] bg-white border-b border-gray-200 shadow-sm px-4 md:px-10 pt-4 pb-8 sm:py-4 flex items-start sm:items-center justify-between"
      data-aos="fade-down"
      data-aos-duration="400"
      data-aos-delay="100"
    >
      <!-- Kiri: Tombol Back -->
      <div class="flex-shrink-0 mt-1 sm:mt-0">
        <a
          href="dashboard_user.html"
          class="font-quantify inline-flex items-center text-sm sm:text-sm text-gray-600 hover:text-black font-medium transition"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-5 w-5 mr-1"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M15 19l-7-7 7-7"
            />
          </svg>
          Kembali
        </a>
      </div>

      <!-- Tengah: Nama Produk dan Harga -->
      <div class="absolute left-1/2 transform -translate-x-1/2 text-center">
        <h1 class="text-base sm:text-lg font-quantify font-bold text-[#0f2d25]">
          Nama Produk Kaos
        </h1>
        <span
          class="text-sm sm:text-base font-quantify font-semibold text-[#0f2d25]"
        >
          Total Harga : Rp 125.000
        </span>
      </div>

      <!-- Kanan: Tombol Aksi -->
      <div
        class="hidden sm:flex sm:static sm:bottom-auto right-4 bottom-6 gap-2 sm:gap-3 flex-shrink-0"
      >
        <!-- Download -->
        <a
          href="#"
          class="flex items-center justify-center gap-2 text-xs sm:text-sm font-quantify px-3 py-1.5 sm:px-4 sm:py-2 border border-[#d1a86f] text-[#0f2d25] bg-[#d1a86f] rounded-full hover:bg-[#c1985e] transition"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-4 w-4 sm:h-5 sm:w-5"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M7 10l5 5m0 0l5-5m-5 5V4"
            />
          </svg>
          Download
        </a>
      </div>
    </div>

    <!-- SECTION DESAIN PRODUK -->
    <div
      class="relative overflow-visible z-0 flex flex-col-reverse lg:flex-row gap-y-6 lg:gap-x-6 mt-[160px] px-4 mb-5 h-auto"
    >
      <!-- === PANEL DESAIN KIRI === -->
      <div
        class="w-full lg:w-80 flex-none bg-white border border-[#d1a86f] p-4 rounded-2xl shadow-lg"
      >
        <!-- Judul -->
        <div class="mb-4">
          <h2 class="text-sm font-bold text-[#0f2d25] uppercase">
            Informasi Desain
          </h2>
          <p class="text-xs italic text-gray-500">(harus diisi !!)</p>
        </div>

        <!-- Ukuran & Jumlah -->
        <div class="mb-4">
          <label class="block text-xs text-[#0f2d25] mb-2 font-quantify"
            >Pilih Ukuran Size & Jumlah</label
          >
          <div class="grid grid-cols-3 gap-4">
            <!-- Ukuran manual agar label tambahan tampil -->
            <!-- XS -->
            <div>
              <label class="block text-xs text-[#0f2d25]">XS</label>
              <input
                type="number"
                min="0"
                placeholder="0"
                class="w-full mt-1 text-center text-sm text-[#0f2d25] bg-white border border-gray-300 rounded focus:ring-[#d1a86f] focus:border-[#d1a86f] focus:outline-none"
              />
            </div>

            <!-- S -->
            <div>
              <label class="block text-xs text-[#0f2d25]">S</label>
              <input
                type="number"
                min="0"
                placeholder="0"
                class="w-full mt-1 text-center text-sm text-[#0f2d25] bg-white border border-gray-300 rounded focus:ring-[#d1a86f] focus:border-[#d1a86f] focus:outline-none"
              />
            </div>

            <!-- M -->
            <div>
              <label class="block text-xs text-[#0f2d25]">M</label>
              <input
                type="number"
                min="0"
                placeholder="0"
                class="w-full mt-1 text-center text-sm text-[#0f2d25] bg-white border border-gray-300 rounded focus:ring-[#d1a86f] focus:border-[#d1a86f] focus:outline-none"
              />
            </div>

            <!-- L -->
            <div>
              <label class="block text-xs text-[#0f2d25]">L</label>
              <input
                type="number"
                min="0"
                placeholder="0"
                class="w-full mt-1 text-center text-sm text-[#0f2d25] bg-white border border-gray-300 rounded focus:ring-[#d1a86f] focus:border-[#d1a86f] focus:outline-none"
              />
            </div>

            <!-- XL -->
            <div>
              <label class="block text-xs text-[#0f2d25]">XL</label>
              <input
                type="number"
                min="0"
                placeholder="0"
                class="w-full mt-1 text-center text-sm text-[#0f2d25] bg-white border border-gray-300 rounded focus:ring-[#d1a86f] focus:border-[#d1a86f] focus:outline-none"
              />
            </div>

            <!-- 2XL -->
            <div>
              <label class="block text-xs text-[#0f2d25]">
                2XL <span class="text-[11px] text-gray-500">(+10.000Rp)</span>
              </label>
              <input
                type="number"
                min="0"
                placeholder="0"
                class="w-full mt-1 text-center text-sm text-[#0f2d25] bg-white border border-gray-300 rounded focus:ring-[#d1a86f] focus:border-[#d1a86f] focus:outline-none"
              />
            </div>

            <!-- 3XL -->
            <div>
              <label class="block text-xs text-[#0f2d25]">
                3XL <span class="text-[11px] text-gray-500">(+15.000Rp)</span>
              </label>
              <input
                type="number"
                min="0"
                placeholder="0"
                class="w-full mt-1 text-center text-sm text-[#0f2d25] bg-white border border-gray-300 rounded focus:ring-[#d1a86f] focus:border-[#d1a86f] focus:outline-none"
              />
            </div>

            <!-- 4XL -->
            <div>
              <label class="block text-xs text-[#0f2d25]">
                4XL <span class="text-[11px] text-gray-500">(+20.000Rp)</span>
              </label>
              <input
                type="number"
                min="0"
                placeholder="0"
                class="w-full mt-1 text-center text-sm text-[#0f2d25] bg-white border border-gray-300 rounded focus:ring-[#d1a86f] focus:border-[#d1a86f] focus:outline-none"
              />
            </div>

            <!-- 5XL -->
            <div>
              <label class="block text-xs text-[#0f2d25]">
                5XL <span class="text-[11px] text-gray-500">(+25.000Rp)</span>
              </label>
              <input
                type="number"
                min="0"
                placeholder="0"
                class="w-full mt-1 text-center text-sm text-[#0f2d25] bg-white border border-gray-300 rounded focus:ring-[#d1a86f] focus:border-[#d1a86f] focus:outline-none"
              />
            </div>
          </div>
        </div>

        <!-- Buat Teks -->
        <div class="mb-4">
          <label class="block text-xs text-[#0f2d25] mb-2 font-quantify"
            >Tambahkan Teks pada Desainmu</label
          >
          <button
            onclick="document.getElementById('fontModal').classList.remove('hidden')"
            class="w-full bg-[#d1a86f] text-[#0f2d25] border border-[#d1a86f] rounded px-4 py-2 text-sm font-semibold hover:bg-[#c1985e] transition"
          >
            Tambah Teks
          </button>
        </div>

        <!-- Kontrol Teks -->
        <div
          class="mb-4 border border-gray-300 p-3 rounded text-xs text-[#0f2d25] bg-gray-50"
        >
          <p class="font-bold mb-2">Kontrol Teks:</p>

          <label class="text-xs">Warna Teks</label>
          <input
            type="color"
            id="textColor"
            class="w-full mb-2 h-8 cursor-pointer"
            value="#000000"
          />

          <label class="text-xs">Background Teks</label>
          <input
            type="color"
            id="textBgColor"
            class="w-full mb-2 h-8 cursor-pointer"
            value="#ffffff"
          />

          <label class="inline-flex items-center space-x-2 mb-2">
            <input
              type="checkbox"
              id="bgTransparent"
              class="accent-[#0f2d25]"
            />
            <span class="text-xs">Transparan</span>
          </label>

          <label class="text-xs">Ukuran Font</label>
          <select
            id="fontSize"
            class="w-full text-sm mb-3 border-gray-300 rounded focus:ring-[#d1a86f]"
          >
            <option value="12">12px</option>
            <option value="14">14px</option>
            <option value="16">16px</option>
            <option value="18">18px</option>
            <option value="20">20px</option>
            <option value="24">24px</option>
            <option value="28">28px</option>
          </select>

          <!-- Baris 1: B / I -->
          <div class="flex gap-2 mb-2 justify-center">
            <button
              id="boldBtn"
              class="w-10 h-10 flex items-center justify-center rounded border hover:bg-gray-100"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-5 h-5 font-bold"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  d="M13 4H6v16h8a4 4 0 000-8h-4"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
            <button
              id="italicBtn"
              class="w-10 h-10 flex items-center justify-center rounded border hover:bg-gray-100 italic"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-5 h-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  d="M10 4h8M6 20h8M14 4l-4 16"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
          </div>

          <!-- Baris 2: Align -->
          <div class="flex gap-2 justify-center">
            <!-- Left -->
            <button
              id="alignLeft"
              class="w-10 h-10 flex items-center justify-center rounded border hover:bg-gray-100"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-5 h-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  d="M3 6h18M3 12h12M3 18h18"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
            <!-- Center -->
            <button
              id="alignCenter"
              class="w-10 h-10 flex items-center justify-center rounded border hover:bg-gray-100"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-5 h-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  d="M6 6h12M4 12h16M6 18h12"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
            <!-- Right -->
            <button
              id="alignRight"
              class="w-10 h-10 flex items-center justify-center rounded border hover:bg-gray-100"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-5 h-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  d="M3 6h18M9 12h12M3 18h18"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
          </div>
        </div>

        <!-- Upload Gambar -->
        <div class="mb-4">
          <label class="block text-xs text-[#0f2d25] mb-2 font-quantify"
            >Letakkan Gambar atau Icon pada Desainmu</label
          >
          <label
            for="upload-photo"
            class="flex flex-col items-center justify-center w-full h-40 border-2 border-dashed border-[#0f2d25] rounded cursor-pointer bg-white hover:bg-gray-50 transition"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-8 w-8 text-[#0f2d25] mb-2"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M7 16v-4m0 0V8m0 4h10m4 4v-8a2 2 0 00-2-2H5a2 2 0 00-2 2v8m16 4H5a2 2 0 01-2-2v-1a2 2 0 012-2h14a2 2 0 012 2v1a2 2 0 01-2 2z"
              />
            </svg>
            <p class="text-sm text-[#0f2d25] font-medium">
              Klik atau drag untuk upload foto/logo
            </p>
            <p class="text-xs text-gray-500">(maks 5MB, jpg/png/svg)</p>
            <input
              id="upload-photo"
              type="file"
              class="hidden"
              accept="image/*"
            />
          </label>
        </div>

        <!-- Komponen Aktif & Aksi -->
        <div class="mt-4">
          <label class="block text-xs text-[#0f2d25] mb-2 font-quantify">
            Komponen Desain Aktif
          </label>
          <div
            id="designList"
            class="space-y-2 mb-4 max-h-48 overflow-y-auto pr-2 custom-scrollbar"
          >
            <p
              id="noComponentsMessage"
              class="text-xs text-gray-500 text-center py-4"
            >
              Belum ada komponen ditambahkan.
            </p>
          </div>

          <button
            id="clearCanvas"
            class="w-full bg-red-600 text-white rounded py-2 text-sm font-semibold hover:bg-red-700 transition"
          >
            Hapus Semua Desain
          </button>

          <button
            id="saveDesign"
            class="w-full bg-green-600 text-white mt-2 rounded py-2 text-sm font-semibold hover:bg-green-700 transition"
          >
            Simpan & Preview Desain
          </button>
        </div>

        <style>
          .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
          }

          .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
          }

          .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
          }

          .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #555;
          }
        </style>
      </div>

      <!-- Modal Font Picker -->
      <div
        id="fontModal"
        class="fixed inset-0 z-[1000] bg-black bg-opacity-40 hidden flex items-start justify-center px-4 pt-[20vh]"
      >
        <div
          class="relative bg-white w-full max-w-2xl sm:rounded-xl shadow-xl p-6 max-h-[90vh] overflow-y-auto"
        >
          <!-- Tombol Close -->
          <button
            onclick="document.getElementById('fontModal').classList.add('hidden')"
            class="absolute top-3 right-3 text-gray-500 hover:text-gray-700 text-xl font-bold"
          >
            ✕
          </button>

          <!-- Judul Modal -->
          <h3 class="text-lg font-bold text-[#0f2d25] mb-4">Pilih Font</h3>

          <!-- Input Pencarian -->
          <input
            type="text"
            id="fontSearch"
            placeholder="Cari font..."
            class="w-full mb-4 px-4 py-2 border border-gray-300 rounded-lg text-sm text-black focus:ring-[#d1a86f] focus:border-[#d1a86f] outline-none"
          />

          <!-- Daftar Font -->
          <div
            id="fontList"
            class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 max-h-[55vh] overflow-y-auto text-black"
          >
            <!-- Font items dari JS -->
          </div>
        </div>
      </div>

      <!-- Modal Deskripsi Produk -->
      <div
        id="modalDeskripsiProduk"
        class="fixed inset-0 z-[999] bg-black bg-opacity-40 flex items-center justify-center px-4 hidden"
      >
        <div
          class="bg-white w-full max-w-md sm:rounded-xl shadow-xl p-6 relative animate-fade-in"
        >
          <button
            onclick="document.getElementById('modalDeskripsiProduk').classList.add('hidden')"
            class="absolute top-3 right-3 text-gray-500 hover:text-gray-700 text-xl font-bold"
          >
            ✕
          </button>
          <h3 class="text-lg font-bold text-[#0f2d25] font-quantify mb-4">
            Deskripsi Produk
          </h3>
          <p class="text-sm text-gray-700 leading-relaxed text-justify">
            Produk ini merupakan kaos berkualitas tinggi yang terbuat dari bahan
            katun premium, nyaman dipakai sepanjang hari. Desain minimalis namun
            elegan membuatnya cocok digunakan dalam berbagai suasana baik formal
            maupun santai.
          </p>
        </div>
      </div>

      <!-- Modal Size Chart -->
      <div
        id="modalSizeChart"
        class="fixed inset-0 z-[999] bg-black bg-opacity-40 flex items-center justify-center px-4 hidden"
      >
        <div
          class="bg-white w-full max-w-md sm:rounded-xl shadow-xl p-6 relative animate-fade-in overflow-x-auto"
        >
          <button
            onclick="document.getElementById('modalSizeChart').classList.add('hidden')"
            class="absolute top-3 right-3 text-gray-500 hover:text-gray-700 text-xl font-bold"
          >
            ✕
          </button>
          <h3 class="text-lg font-bold text-[#0f2d25] font-quantify mb-4">
            Size Chart Ukuran (cm)
          </h3>
          <table class="w-full text-sm border border-[#0f2d25]">
            <thead class="bg-[#0f2d25] text-white font-semibold">
              <tr>
                <th class="px-3 py-2 border border-white">Size</th>
                <th class="px-3 py-2 border border-white">Lebar</th>
                <th class="px-3 py-2 border border-white">Panjang</th>
              </tr>
            </thead>
            <tbody class="text-[#0f2d25] text-center">
              <tr>
                <td class="border px-3 py-1">XS</td>
                <td class="border px-3 py-1">42</td>
                <td class="border px-3 py-1">61</td>
              </tr>
              <tr>
                <td class="border px-3 py-1">S</td>
                <td class="border px-3 py-1">45</td>
                <td class="border px-3 py-1">64</td>
              </tr>
              <tr>
                <td class="border px-3 py-1">M</td>
                <td class="border px-3 py-1">48</td>
                <td class="border px-3 py-1">67</td>
              </tr>
              <tr>
                <td class="border px-3 py-1">L</td>
                <td class="border px-3 py-1">50</td>
                <td class="border px-3 py-1">70</td>
              </tr>
              <tr>
                <td class="border px-3 py-1">XL</td>
                <td class="border px-3 py-1">53</td>
                <td class="border px-3 py-1">75</td>
              </tr>
              <tr>
                <td class="border px-3 py-1">2XL</td>
                <td class="border px-3 py-1">56</td>
                <td class="border px-3 py-1">75</td>
              </tr>
              <tr>
                <td class="border px-3 py-1">3XL</td>
                <td class="border px-3 py-1">59</td>
                <td class="border px-3 py-1">75</td>
              </tr>
              <tr>
                <td class="border px-3 py-1">4XL</td>
                <td class="border px-3 py-1">62</td>
                <td class="border px-3 py-1">75</td>
              </tr>
              <tr>
                <td class="border px-3 py-1">5XL</td>
                <td class="border px-3 py-1">65</td>
                <td class="border px-3 py-1">75</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Area Canvas di dalam div Tailwind -->
      <div
        class="w-full h-full border-2 border-dashed border-gray-300 rounded-2xl flex items-center justify-center bg-white px-6 py-6 relative"
      >
        <!-- 2 button -->
        <div
          class="absolute top-8 left-8 sm:top-6 sm:left-6 z-50 flex flex-col gap-2 sm:gap-4"
        >
          <!-- Icon 1 - Deskripsi Produk -->
          <div class="group relative">
            <button
              onclick="document.getElementById('modalDeskripsiProduk').classList.remove('hidden')"
              class="w-8 h-8 sm:w-12 sm:h-12 rounded-md sm:rounded-lg bg-[#d1a86f] text-[#0f2d25] flex items-center justify-center shadow hover:bg-[#c1985e] transition"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-4 h-4 sm:w-6 sm:h-6"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M9 12h6m-6 4h6M9 8h6M4 6a2 2 0 012-2h8l4 4v12a2 2 0 01-2 2H6a2 2 0 01-2-2V6z"
                />
              </svg>
            </button>
            <span
              class="hidden sm:block absolute sm:left-14 sm:top-1/2 sm:-translate-y-1/2 bg-[#0f2d25] text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition duration-300 whitespace-nowrap z-50"
            >
              Deskripsi Produk
            </span>
          </div>

          <!-- Icon 2 - Size Chart -->
          <div class="group relative">
            <button
              onclick="document.getElementById('modalSizeChart').classList.remove('hidden')"
              class="w-8 h-8 sm:w-12 sm:h-12 rounded-md sm:rounded-lg bg-[#d1a86f] text-[#0f2d25] flex items-center justify-center shadow hover:bg-[#c1985e] transition"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-4 h-4 sm:w-6 sm:h-6"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"
                />
              </svg>
            </button>
            <span
              class="hidden sm:block absolute sm:left-14 sm:top-1/2 sm:-translate-y-1/2 bg-[#0f2d25] text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition duration-300 whitespace-nowrap z-50"
            >
              Size/Ukuran Chart
            </span>
          </div>
        </div>

        <!-- canvas section  -->
        <canvas
          id="tshirtCanvas"
          width="600"
          height="600"
          class="z-0 w-full max-w-full aspect-square sm:aspect-[1/1] h-[280px] sm:h-auto object-contain"
        ></canvas>

        <!-- Panel Kontrol Interaktif -->
        <div
          class="absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-white border border-gray-300 rounded-xl shadow-xl px-2.5 sm:px-4 py-2 sm:py-3 flex flex-nowrap justify-center items-center gap-1.5 sm:gap-2 w-full max-w-[320px] sm:max-w-[560px] z-30 overflow-x-auto"
        >
          <div class="flex items-center gap-1 sm:gap-2 flex-shrink-0">
            <span class="text-[10px] sm:text-sm text-gray-700 font-medium"
              >Zoom :</span
            >
            <select
              class="appearance-none bg-white border border-gray-300 text-gray-800 text-[10px] sm:text-sm px-1.5 sm:px-3 py-0.5 sm:py-1.5 rounded focus:outline-none cursor-pointer h-6 sm:h-8"
            >
              <option>50%</option>
              <option>75%</option>
              <option selected>100%</option>
              <option>125%</option>
              <option>150%</option>
            </select>
          </div>

          <button
            class="flex-shrink-0 flex items-center gap-1 sm:gap-2 bg-white border border-gray-300 hover:bg-gray-100 text-gray-800 text-[10px] sm:text-sm px-1.5 sm:px-3 py-0.5 sm:py-1.5 rounded transition h-6 sm:h-8"
          >
            <svg
              class="w-3.5 h-3.5 sm:w-5 sm:h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M15 19l-7-7 7-7"
              />
            </svg>
            Depan
          </button>

          <button
            class="flex-shrink-0 flex items-center gap-1 sm:gap-2 bg-white border border-gray-300 hover:bg-gray-100 text-gray-800 text-[10px] sm:text-sm px-1.5 sm:px-3 py-0.5 sm:py-1.5 rounded transition h-6 sm:h-8"
          >
            <svg
              class="w-3.5 h-3.5 sm:w-5 sm:h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 5l7 7-7 7"
              />
            </svg>
            Belakang
          </button>

          <button
            id="previewButton"
            class="flex-shrink-0 flex items-center gap-1 sm:gap-2 bg-white border border-gray-300 hover:bg-gray-100 text-gray-800 text-[10px] sm:text-sm px-1.5 sm:px-3 py-0.5 sm:py-1.5 rounded transition h-6 sm:h-8"
          >
            <svg
              class="w-3.5 h-3.5 sm:w-5 sm:h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
              />
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M2.458 12C3.732 7.943 7.523 5 12 5s8.268 2.943 9.542 7c-1.274 4.057-5.065 7-9.542 7s-8.268-2.943-9.542-7z"
              />
            </svg>
            Preview
          </button>
        </div>

        <!-- preview modal pop up -->
        <div
          id="previewModal"
          class="fixed inset-0 bg-black bg-opacity-75 flex justify-center items-center z-50 hidden"
        >
          <div
            class="bg-white rounded-lg shadow-xl p-4 sm:p-6 relative max-w-full mx-4 sm:mx-0 w-full md:w-[600px] lg:w-[500px] xl:w-[400px] mt-20 mb-4"
          >
            <h1
              class="text-xl sm:text-2xl font-extrabold text-center mb-6 text-[#0f2d25]"
            >
              Hasil Product Anda
            </h1>

            <button
              id="closeModalButton"
              class="absolute top-3 right-3 text-gray-500 hover:text-gray-800 text-2xl font-bold"
            >
              &times;
            </button>

            <div
              class="flex justify-center items-center bg-gray-100 p-2 rounded-md"
            >
              <img
                id="designPreviewImage"
                src="placeholder_baju.png"
                alt="Desain Baju Preview"
                class="max-w-full h-auto object-contain"
              />
            </div>
            <p class="text-sm text-gray-600 mt-4 text-center">
              Ini adalah tampilan pratinjau desain baju Anda.
            </p>

            <div class="flex justify-center gap-4 mt-6">
              <button
                id="frontViewButton"
                class="flex-shrink-0 flex items-center gap-1 sm:gap-2 bg-white border border-gray-300 hover:bg-gray-100 text-gray-800 text-[10px] sm:text-sm px-1.5 sm:px-3 py-0.5 sm:py-1.5 rounded transition h-8"
              >
                <svg
                  class="w-3.5 h-3.5 sm:w-5 sm:h-5"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M15 19l-7-7 7-7"
                  />
                </svg>
                Depan
              </button>

              <button
                id="backViewButton"
                class="flex-shrink-0 flex items-center gap-1 sm:gap-2 bg-white border border-gray-300 hover:bg-gray-100 text-gray-800 text-[10px] sm:text-sm px-1.5 sm:px-3 py-0.5 sm:py-1.5 rounded transition h-8"
              >
                <svg
                  class="w-3.5 h-3.5 sm:w-5 sm:h-5"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 5l7 7-7 7"
                  />
                </svg>
                Belakang
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- === Tombol Aksi Mobile (Hanya muncul di mobile) === -->
    <div class="sm:hidden mt-4 px-4 w-full">
      <div class="flex flex-col gap-3 w-full">
        <a
          href="#"
          class="w-full flex items-center justify-center gap-2 text-sm font-quantify px-4 py-3 border border-[#d1a86f] text-[#0f2d25] bg-[#d1a86f] rounded-xl hover:bg-[#c1985e] transition"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-5 w-5"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M7 10l5 5m0 0l5-5m-5 5V4"
            />
          </svg>
          Download
        </a>
      </div>
    </div>

    <!-- Footer Section -->
    <footer class="w-full bg-[#0f2d25] text-white mt-10">
      <div
        class="max-w-[1500px] mx-auto px-4 sm:px-6 md:px-12 lg:px-20 xl:px-24 py-12"
      >
        <!-- Top Section -->
        <div
          class="flex flex-col md:flex-row justify-between items-center pb-8 mb-8 border-b border-[#15453a]"
        >
          <!-- Logo and Tagline -->
          <div
            class="flex flex-col md:items-start items-center text-center md:text-left mb-4 md:mb-0"
          >
            <div class="flex items-center mb-2">
              <img
                src="image/icon.JPG"
                alt="SKAWAN INDUSTRIES Logo"
                class="w-10 h-10 rounded-full mr-3"
              />
              <h3
                class="font-quantify text-xl sm:text-2xl font-bold text-[#d1a86f]"
              >
                SKAWAN INDUSTRIES
              </h3>
            </div>
            <h6 class="text-sm text-white font-quantify">
              Start order now and get a cool design product
            </h6>
          </div>
        </div>

        <!-- Grid Section -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
          <!-- Alamat -->
          <div class="flex flex-col items-start text-left">
            <h4 class="font-bold text-lg text-white font-quantify">Alamat</h4>
            <div class="w-12 h-1 bg-white mt-1 mb-4"></div>
            <p class="text-white mb-4 font-quantify">
              Jl. Puri Airlangga No.20 blok P, Kapasan, Sidokare, Sidoarjo,
              Sidoarjo Regency, East Java 61214
            </p>
            <!-- Wrapper Peta -->
            <div
              class="relative w-full h-0 md:h-[320px] rounded-lg overflow-hidden transition-all duration-300"
            >
              <iframe
                src="https://www.google.com/maps?q=-7.446144,112.707078&hl=es;z=14&output=embed"
                class="w-full h-full filter grayscale contrast-110 pointer-events-none hidden md:block"
                allowfullscreen
                loading="lazy"
                referrerpolicy="no-referrer-when-downgrade"
                style="border: 0"
              ></iframe>
            </div>
          </div>

          <!-- Follow Us On -->
          <div class="flex flex-col items-start text-left">
            <h4 class="font-bold text-lg text-white font-quantify">
              Follow Us On :
            </h4>
            <div class="w-12 h-1 bg-white mt-1 mb-4"></div>
            <div class="flex flex-col space-y-4">
              <!-- WhatsApp -->
              <a
                href="https://wa.me/6289649710370"
                target="_blank"
                class="flex items-center space-x-3 group"
              >
                <div
                  class="w-10 h-10 flex items-center justify-center rounded-full bg-white/10 group-hover:bg-white/20 transition"
                >
                  <img
                    src="image/whatsapp_icon.png"
                    alt="WhatsApp"
                    class="w-5 h-5"
                  />
                </div>
                <span class="text-white font-quantify">WhatsApp</span>
              </a>

              <!-- Instagram -->
              <a
                href="https://www.instagram.com/skawanindustries?igsh=MzJqMWdwb294Mnk4"
                target="_blank"
                class="flex items-center space-x-3 group"
              >
                <div
                  class="w-10 h-10 flex items-center justify-center rounded-full bg-white/10 group-hover:bg-white/20 transition"
                >
                  <img
                    src="image/instagram_icon.png"
                    alt="Instagram"
                    class="w-5 h-5"
                  />
                </div>
                <span class="text-white font-quantify">Instagram</span>
              </a>

              <!-- Shopee -->
              <a
                href="http://shopee.co.id/skawanindustries"
                target="_blank"
                class="flex items-center space-x-3 group"
              >
                <div
                  class="w-10 h-10 flex items-center justify-center rounded-full bg-white/10 group-hover:bg-white/20 transition"
                >
                  <img
                    src="image/shopee_icon.png"
                    alt="Shopee"
                    class="w-5 h-5"
                  />
                </div>
                <span class="text-white font-quantify">Shopee</span>
              </a>
            </div>
          </div>

          <!-- Get In Touch -->
          <div class="flex flex-col items-start text-left">
            <h4 class="font-bold text-lg text-white font-quantify">
              Get In Touch With Us
            </h4>
            <div class="w-12 h-1 bg-white mt-1 mb-4"></div>
            <p class="text-white font-quantify">Phone: +62 8819 727 687</p>
            <p class="text-white mt-4 font-quantify">
              Senin–Jumat:<br />9.00 – 20.00
            </p>
            <p class="text-white mt-4 font-quantify">
              Saturday-Minggu:<br />10.00 – 17.00
            </p>
            <p class="text-white mt-4 font-quantify">
              support@skawanindustries.com
            </p>
          </div>

          <!-- Quick Links -->
          <div class="flex flex-col items-start text-left">
            <h4 class="font-bold text-lg text-white font-quantify">
              Quick Links
            </h4>
            <div class="w-12 h-1 bg-white mt-1 mb-4"></div>
            <ul class="space-y-2">
              <li>
                <a
                  href="index.html"
                  class="text-white hover:text-green-300 font-quantify"
                  >Home Page</a
                >
              </li>
              <li>
                <a
                  href="list_product.html"
                  class="text-white hover:text-green-300 font-quantify"
                  >category1</a
                >
              </li>
              <li>
                <a
                  href="list_product.html"
                  class="text-white hover:text-green-300 font-quantify"
                  >category2</a
                >
              </li>
              <li>
                <a
                  href="list_product.html"
                  class="text-white hover:text-green-300 font-quantify"
                  >category3</a
                >
              </li>
              <li>
                <a
                  href="list_product.html"
                  class="text-white hover:text-green-300 font-quantify"
                  >category4</a
                >
              </li>
              <li>
                <a
                  href="list_product.html"
                  class="text-white hover:text-green-300 font-quantify"
                  >category5</a
                >
              </li>
            </ul>
          </div>
        </div>

        <!-- Bottom Footer -->
        <div
          class="mt-12 pt-6 border-t border-[#15453a] flex flex-col md:flex-row justify-between items-center text-sm text-white gap-4"
        >
          <!-- Left: Follow Us On -->
          <div class="flex items-center space-x-4">
            <span class="font-quantify text-white">Follow Us On:</span>

            <!-- WhatsApp -->
            <a
              href="https://wa.me/6289649710370"
              target="_blank"
              class="hover:text-green-300 transition"
            >
              <img
                src="image/whatsapp_icon.png"
                alt="WhatsApp"
                class="w-5 h-5"
              />
            </a>

            <!-- Instagram -->
            <a
              href="https://www.instagram.com/skawanindustries?igsh=MzJqMWdwb294Mnk4"
              target="_blank"
              class="hover:text-green-300 transition"
            >
              <img
                src="image/instagram_icon.png"
                alt="Instagram"
                class="w-5 h-5"
              />
            </a>
          </div>

          <!-- Center: Copyright -->
          <p class="text-center w-full md:w-auto font-quantify">
            © 2025 SKAWAN INDUSTRIES. All rights reserved.
          </p>

          <!-- Right: Kosong -->
          <div class="w-[120px] h-5 hidden md:block"></div>
        </div>
      </div>
    </footer>

    <!-- swiper js -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <!-- AOS JS Fade Up/Fade Down -->
    <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
    <script>
      AOS.init();
    </script>
    <!-- tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- fabric js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js"></script>
    <!-- custom js -->
    <script src="js/script.js"></script>
    <!-- design features js -->
    <script>
      // design features js
      // ============================
      // === FONT SIZE & FONT API ===
      // ============================
      const fontSizeSelect = document.getElementById("fontSize");
      if (fontSizeSelect) {
        for (let i = 10; i <= 64; i += 2) {
          const opt = document.createElement("option");
          opt.value = i;
          opt.textContent = `${i}px`;
          fontSizeSelect.appendChild(opt);
        }
      }

      let currentFont = "Arial";
      let fontsList = [];
      const apiKey = "AIzaSyBbHsIzkkLsTKLNRcomvRlw-qZqWeC91OU"; // Ganti dengan API Key Google Fonts Anda yang valid

      fetch(`https://www.googleapis.com/webfonts/v1/webfonts?key=${apiKey}`)
        .then((r) => r.json())
        .then((d) => {
          fontsList = d.items.map((i) => i.family);
          renderFonts(fontsList);
        })
        .catch((error) => console.error("Error fetching fonts:", error));

      function renderFonts(arr) {
        const container = document.getElementById("fontList");
        if (!container) return;

        container.innerHTML = "";

        arr.slice(0, 50).forEach((font) => {
          const fontId = `font-link-${font.replace(/[^a-zA-Z0-9]/g, "")}`;
          if (!document.getElementById(fontId)) {
            const link = document.createElement("link");
            link.id = fontId;
            link.rel = "stylesheet";
            link.href = `https://fonts.googleapis.com/css2?family=${font.replace(
              / /g,
              "+"
            )}&display=swap`;
            document.head.appendChild(link);
          }

          const div = document.createElement("div");
          div.className =
            "border p-2 rounded text-center text-sm cursor-pointer hover:bg-gray-100 mb-1 font-list-item"; // Menambahkan kelas untuk styling
          div.textContent = font;
          div.style.fontFamily = font;
          div.onclick = () => {
            currentFont = font;
            const fontModal = document.getElementById("fontModal"); // Asumsi ada modal font

            const activeObject = canvas.getActiveObject();
            if (activeObject && activeObject.type === "textbox") {
              activeObject.set({ fontFamily: currentFont });
              canvas.renderAll();
              updateUIFromActiveObject();
            } else {
              addTextToCanvas(currentFont);
            }

            if (fontModal) {
              fontModal.classList.add("hidden");
            }
          };
          container.appendChild(div);
        });
      }

      const fontSearchInput = document.getElementById("fontSearch");
      if (fontSearchInput) {
        fontSearchInput.oninput = (e) => {
          const q = e.target.value.toLowerCase();
          renderFonts(fontsList.filter((f) => f.toLowerCase().includes(q)));
        };
      }

      // =======================
      // === INIT FABRIC JS ===
      // =======================
      const canvas = new fabric.Canvas("tshirtCanvas", {
        preserveObjectStacking: true,
        selection: true,
        controlsAboveOverlay: true,
      });

      let bgImageObject = null;

      const setBackgroundImage = (imgUrl) => {
        fabric.Image.fromURL(imgUrl, (img) => {
          bgImageObject = img;
          // Skala gambar background agar mengisi kanvas tanpa distorsi berlebihan,
          // sambil tetap menjaga proporsi.
          // Disesuaikan agar gambar baju berada di tengah dan terlihat baik.
          const canvasWidth = canvas.getWidth();
          const canvasHeight = canvas.getHeight();
          const imgAspectRatio = img.width / img.height;
          const canvasAspectRatio = canvasWidth / canvasHeight;

          let scale;
          if (imgAspectRatio > canvasAspectRatio) {
            // Gambar lebih lebar dari kanvas, sesuaikan tinggi
            scale = canvasHeight / img.height;
          } else {
            // Gambar lebih tinggi dari kanvas, sesuaikan lebar
            scale = canvasWidth / img.width;
          }

          img.scale(scale);

          const centerX = (canvasWidth - img.width * scale) / 2;
          const centerY = (canvasHeight - img.height * scale) / 2;

          canvas.setBackgroundImage(img, canvas.renderAll.bind(canvas), {
            left: centerX,
            top: centerY,
            originX: "left",
            originY: "top",
            selectable: false,
            evented: false,
          });

          // Pastikan fungsi ini hanya ditambahkan sekali
          canvas.off("after:render", updateBgImagePositionOnRender);
          canvas.on("after:render", updateBgImagePositionOnRender);
        });
      };

      const updateBgImagePositionOnRender = () => {
        if (bgImageObject) {
          const canvasWidth = canvas.getWidth();
          const canvasHeight = canvas.getHeight();
          const imgAspectRatio = bgImageObject.width / bgImageObject.height;
          const canvasAspectRatio = canvasWidth / canvasHeight;

          let currentScale;
          if (imgAspectRatio > canvasAspectRatio) {
            currentScale = canvasHeight / bgImageObject.height;
          } else {
            currentScale = canvasWidth / bgImageObject.width;
          }

          const scaledWidth = bgImageObject.width * currentScale;
          const scaledHeight = bgImageObject.height * currentScale;

          const currentCenterX = (canvasWidth - scaledWidth) / 2;
          const currentCenterY = (canvasHeight - scaledHeight) / 2;

          bgImageObject.set({
            left: currentCenterX,
            top: currentCenterY,
            scaleX: currentScale,
            scaleY: currentScale,
          });
          // Tidak perlu canvas.renderAll() di sini karena ini sudah dalam event after:render
        }
      };

      // Mengatur background produk awal
      setBackgroundImage("image/product4.jpeg");

      const loadCustomFontsFromDesign = (json) => {
        const designData = JSON.parse(json);
        if (designData && designData.objects) {
          designData.objects.forEach((obj) => {
            if (obj.type === "textbox" && obj.fontFamily) {
              const font = obj.fontFamily;
              const fontId = `font-link-${font.replace(/[^a-zA-Z0-9]/g, "")}`;
              if (!document.getElementById(fontId)) {
                const link = document.createElement("link");
                link.id = fontId;
                link.rel = "stylesheet";
                link.href = `https://fonts.googleapis.com/css2?family=${font.replace(
                  / /g,
                  "+"
                )}&display=swap`;
                document.head.appendChild(link);
              }
            }
          });
        }
      };

      const savedDesign = localStorage.getItem("kaosDesign");
      if (savedDesign) {
        loadCustomFontsFromDesign(savedDesign);
        canvas.loadFromJSON(savedDesign, () => {
          canvas.renderAll();
          updateDesignList();
          updateUIFromActiveObject();
        });
      }

      function addTextToCanvas(font = "Arial") {
        const textColorInput = document.getElementById("textColor");
        const fontSizeInput = document.getElementById("fontSize");
        const bgTransparentCheckbox = document.getElementById("bgTransparent");
        const textBgColorInput = document.getElementById("textBgColor");

        const text = new fabric.Textbox("Teks Baru", {
          left: 100,
          top: 100,
          fontFamily: font,
          fontSize: parseInt(fontSizeInput ? fontSizeInput.value : 16),
          fill: textColorInput ? textColorInput.value : "#000000",
          backgroundColor:
            bgTransparentCheckbox && bgTransparentCheckbox.checked
              ? ""
              : textBgColorInput
              ? textBgColorInput.value
              : "#ffffff",
          fontWeight: "normal",
          fontStyle: "normal",
          textAlign: "left",
          selectable: true,
          evented: true,
          hasControls: true,
          hasBorders: true,
          cornerColor: "#d1a86f",
          cornerSize: 10,
          transparentCorners: false,
          padding: 5,
        });
        canvas.add(text).setActiveObject(text);
        canvas.renderAll();
        updateDesignList();
        updateUIFromActiveObject();
      }

      // Event listener untuk tombol "Tambah Teks"
      const addTextButton = document.getElementById("addTextButton");
      if (addTextButton) {
        addTextButton.addEventListener("click", () =>
          addTextToCanvas(currentFont)
        );
      }

      // === Garis bantu center fix ===
      const guideLineX = new fabric.Line(
        [0, canvas.getHeight() / 2, canvas.getWidth(), canvas.getHeight() / 2],
        {
          stroke: "#dc2626", // merah
          strokeWidth: 1,
          selectable: false,
          evented: false,
          visible: false,
          originX: "left",
          originY: "top",
        }
      );

      const guideLineY = new fabric.Line(
        [canvas.getWidth() / 2, 0, canvas.getWidth() / 2, canvas.getHeight()],
        {
          stroke: "#dc2626", // merah
          strokeWidth: 1,
          selectable: false,
          evented: false,
          visible: false,
          originX: "left",
          originY: "top",
        }
      );

      canvas.add(guideLineX);
      canvas.add(guideLineY);

      // === Label koordinat X dan Y ===
      const labelX = new fabric.Text("", {
        fontSize: 12,
        fill: "#dc2626",
        backgroundColor: "rgba(255,255,255,0.8)",
        originX: "left",
        originY: "top",
        selectable: false,
        evented: false,
        visible: false,
      });

      const labelY = new fabric.Text("", {
        fontSize: 12,
        fill: "#dc2626",
        backgroundColor: "rgba(255,255,255,0.8)",
        originX: "left",
        originY: "top",
        selectable: false,
        evented: false,
        visible: false,
      });

      canvas.add(labelX);
      canvas.add(labelY);

      // === Event drag (moving) ===
      canvas.on("object:moving", function (e) {
        const obj = e.target;
        if (
          !obj ||
          obj === bgImageObject ||
          obj === guideLineX ||
          obj === guideLineY ||
          obj === labelX ||
          obj === labelY
        ) {
          guideLineX.set("visible", false);
          guideLineY.set("visible", false);
          labelX.set("visible", false);
          labelY.set("visible", false);
          canvas.renderAll();
          return;
        }

        const centerX = canvas.getWidth() / 2;
        const centerY = canvas.getHeight() / 2;
        const objCenter = obj.getCenterPoint();
        const tolerance = 5;

        const isCenterX = Math.abs(objCenter.x - centerX) < tolerance;
        const isCenterY = Math.abs(objCenter.y - centerY) < tolerance;

        guideLineX.set({
          visible: true,
          strokeWidth: isCenterY ? 2.5 : 1,
          x1: 0,
          y1: centerY,
          x2: canvas.getWidth(),
          y2: centerY,
        });

        guideLineY.set({
          visible: true,
          strokeWidth: isCenterX ? 2.5 : 1,
          x1: centerX,
          y1: 0,
          x2: centerX,
          y2: canvas.getHeight(),
        });

        if (isCenterX) obj.left = centerX - obj.getScaledWidth() / 2;
        if (isCenterY) obj.top = centerY - obj.getScaledHeight() / 2;

        const x = Math.round(obj.left ?? 0);
        const y = Math.round(obj.top ?? 0);

        labelX.set({
          text: `X: ${x}`,
          left: obj.left,
          top: obj.top - 20,
          visible: true,
        });

        labelY.set({
          text: `Y: ${y}`,
          left: obj.left,
          top: obj.top - 35,
          visible: true,
        });

        canvas.bringToFront(labelX);
        canvas.bringToFront(labelY);

        canvas.renderAll();
      });

      canvas.on("mouse:up", () => {
        guideLineX.set("visible", false);
        guideLineY.set("visible", false);
        labelX.set("visible", false);
        labelY.set("visible", false);
        canvas.renderAll();
      });

      // ===============================
      // === UPDATE UI DARI OBJEK ===
      // ===============================
      function updateUIFromActiveObject() {
        const o = canvas.getActiveObject();
        const textColor = document.getElementById("textColor");
        const fontSize = document.getElementById("fontSize");
        const textBgColor = document.getElementById("textBgColor");
        const bgTransparent = document.getElementById("bgTransparent");
        const boldBtn = document.getElementById("boldBtn");
        const italicBtn = document.getElementById("italicBtn");
        const alignLeft = document.getElementById("alignLeft");
        const alignCenter = document.getElementById("alignCenter");
        const alignRight = document.getElementById("alignRight");

        if (!o || o.type !== "textbox") {
          if (textColor) textColor.value = "#000000";
          if (fontSize) fontSize.value = "16";
          if (textBgColor) textBgColor.value = "#ffffff";
          if (bgTransparent) bgTransparent.checked = false;

          [boldBtn, italicBtn, alignLeft, alignCenter, alignRight].forEach(
            (btn) => {
              if (btn) btn.classList.remove("bg-gray-300");
            }
          );
          return;
        }

        if (textColor) textColor.value = o.fill || "#000000";
        if (fontSize) fontSize.value = o.fontSize || 16;
        if (textBgColor) textBgColor.value = o.backgroundColor || "#ffffff";
        if (bgTransparent) bgTransparent.checked = !o.backgroundColor;

        [boldBtn, italicBtn].forEach((btn) => {
          if (btn) btn.classList.remove("bg-gray-300");
        });
        if (boldBtn && o.fontWeight === "bold")
          boldBtn.classList.add("bg-gray-300");
        if (italicBtn && o.fontStyle === "italic")
          italicBtn.classList.add("bg-gray-300");

        [alignLeft, alignCenter, alignRight].forEach((btn) => {
          if (btn) btn.classList.remove("bg-gray-300");
        });
        const alignId =
          "align" + o.textAlign.charAt(0).toUpperCase() + o.textAlign.slice(1);
        const activeAlignBtn = document.getElementById(alignId);
        if (activeAlignBtn) activeAlignBtn.classList.add("bg-gray-300");
      }

      canvas.on("selection:created", updateUIFromActiveObject);
      canvas.on("selection:updated", updateUIFromActiveObject);
      canvas.on("object:modified", updateUIFromActiveObject);
      canvas.on("selection:cleared", updateUIFromActiveObject);

      // ======================
      // === TEXT CONTROL ====
      // ======================
      function updateActiveText(prop, val) {
        const o = canvas.getActiveObject();
        if (o && o.type === "textbox") {
          o.set(prop, val);
          canvas.renderAll();
          updateUIFromActiveObject();
        }
      }

      const textColorInput = document.getElementById("textColor");
      if (textColorInput) {
        textColorInput.onchange = (e) =>
          updateActiveText("fill", e.target.value);
      }

      const textBgColorInput = document.getElementById("textBgColor");
      const bgTransparentCheckbox = document.getElementById("bgTransparent");

      if (textBgColorInput) {
        textBgColorInput.onchange = (e) => {
          const v =
            bgTransparentCheckbox && bgTransparentCheckbox.checked
              ? ""
              : e.target.value;
          updateActiveText("backgroundColor", v);
        };
      }

      if (bgTransparentCheckbox) {
        bgTransparentCheckbox.onchange = () => {
          const val = bgTransparentCheckbox.checked
            ? ""
            : textBgColorInput
            ? textBgColorInput.value
            : "#ffffff";
          updateActiveText("backgroundColor", val);
        };
      }

      const fontSizeInput = document.getElementById("fontSize");
      if (fontSizeInput) {
        fontSizeInput.onchange = (e) =>
          updateActiveText("fontSize", parseInt(e.target.value));
      }

      const boldBtn = document.getElementById("boldBtn");
      if (boldBtn) {
        boldBtn.onclick = () => {
          const o = canvas.getActiveObject();
          if (o && o.type === "textbox") {
            const isBold = o.fontWeight === "bold";
            o.set("fontWeight", isBold ? "normal" : "bold");
            canvas.renderAll();
            updateUIFromActiveObject();
          }
        };
      }

      const italicBtn = document.getElementById("italicBtn");
      if (italicBtn) {
        italicBtn.onclick = () => {
          const o = canvas.getActiveObject();
          if (o && o.type === "textbox") {
            const isItalic = o.fontStyle === "italic";
            o.set("fontStyle", isItalic ? "normal" : "italic");
            canvas.renderAll();
            updateUIFromActiveObject();
          }
        };
      }

      ["alignLeft", "alignCenter", "alignRight"].forEach((id) => {
        const alignButton = document.getElementById(id);
        if (alignButton) {
          alignButton.onclick = () => {
            const o = canvas.getActiveObject();
            if (o && o.type === "textbox") {
              o.set("textAlign", id.replace("align", "").toLowerCase());
              canvas.renderAll();
              updateUIFromActiveObject();
            }
          };
        }
      });

      // =====================
      // === GAMBAR UPLOAD ===
      // =====================
      const uploadPhotoInput = document.getElementById("upload-photo");
      if (uploadPhotoInput) {
        uploadPhotoInput.onchange = (e) => {
          const file = e.target.files[0];
          if (!file) return;
          const reader = new FileReader();
          reader.onload = (f) => {
            fabric.Image.fromURL(f.target.result, (img) => {
              img.set({
                left: 50,
                top: 50,
                selectable: true,
                evented: true,
                hasControls: true,
                hasBorders: true,
                cornerColor: "#d1a86f",
                cornerSize: 10,
                transparentCorners: false,
                padding: 5,
              });

              const maxDim = Math.max(img.width, img.height);
              const scaleFactor = 150 / maxDim;
              img.scale(scaleFactor);

              canvas.add(img).setActiveObject(img);
              canvas.renderAll();
              updateDesignList();
            });
          };
          reader.readAsDataURL(file);
          e.target.value = "";
        };
      }

      // ============================
      // === DESIGN LIST & SAVE ====
      // ============================
      function updateDesignList() {
        const designListContainer = document.getElementById("designList");
        const noComponentsMessage = document.getElementById(
          "noComponentsMessage"
        );
        if (!designListContainer || !noComponentsMessage) return;

        // Bersihkan semua elemen anak dari designListContainer KECUALI noComponentsMessage
        while (designListContainer.children.length > 0) {
          const lastChild = designListContainer.lastChild;
          if (lastChild && lastChild.id !== "noComponentsMessage") {
            designListContainer.removeChild(lastChild);
          } else if (lastChild && lastChild.id === "noComponentsMessage") {
            break;
          } else {
            designListContainer.removeChild(lastChild);
          }
        }

        let hasComponents = false;

        const drawableObjects = canvas.getObjects().filter((o) => {
          const isInternalFabricObject =
            o === bgImageObject ||
            o === guideLineX ||
            o === guideLineY ||
            o === labelX ||
            o === labelY;
          return (
            !isInternalFabricObject &&
            (o.type === "textbox" || o.type === "image")
          );
        });

        if (drawableObjects.length > 0) {
          hasComponents = true;
          const fragment = document.createDocumentFragment();
          drawableObjects.forEach((o, i) => {
            const componentCard = document.createElement("div");
            componentCard.className =
              "flex items-center justify-between bg-white border border-gray-200 rounded-lg p-3 shadow-sm mb-2";

            const componentName = document.createElement("span");
            componentName.className =
              "text-sm font-medium text-[#0f2d25] truncate";
            componentName.textContent =
              o.type === "textbox" ? `Teks: "${o.text}"` : `Gambar ${i + 1}`;

            const delBtn = document.createElement("button");
            delBtn.className =
              "p-1 rounded-full text-red-500 hover:bg-red-100 hover:text-red-700 transition flex items-center justify-center";

            delBtn.innerHTML = `
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
        </svg>
      `;

            delBtn.onclick = () => {
              canvas.remove(o);
              canvas.discardActiveObject();
              canvas.renderAll();
              updateDesignList();
              updateUIFromActiveObject();
            };

            componentCard.appendChild(componentName);
            componentCard.appendChild(delBtn);
            fragment.appendChild(componentCard);
          });
          designListContainer.appendChild(fragment);
        }

        if (!hasComponents) {
          noComponentsMessage.classList.remove("hidden");
        } else {
          noComponentsMessage.classList.add("hidden");
        }
      }

      const saveDesignButton = document.getElementById("saveDesign");
      if (saveDesignButton) {
        saveDesignButton.onclick = () => {
          const json = JSON.stringify(canvas.toJSON());
          localStorage.setItem("kaosDesign", json);
          // Mengubah ini jika Anda ingin tetap menggunakan modal
          window.location.href = "preview_product.html";
        };
      }

      const clearCanvasButton = document.getElementById("clearCanvas");
      if (clearCanvasButton) {
        clearCanvasButton.onclick = () => {
          canvas.getObjects().forEach((obj) => {
            if (
              obj !== bgImageObject &&
              obj !== guideLineX &&
              obj !== guideLineY &&
              obj !== labelX &&
              obj !== labelY
            ) {
              canvas.remove(obj);
            }
          });
          canvas.discardActiveObject();
          canvas.renderAll();
          updateDesignList();
          updateUIFromActiveObject();
        };
      }

      window.addEventListener("resize", () => {
        const canvasWrapper = document.getElementById("canvas-wrapper");
        if (canvasWrapper) {
          canvas.setWidth(canvasWrapper.clientWidth);
          canvas.setHeight(canvasWrapper.clientHeight);
          canvas.renderAll();
          // Memanggil ulang untuk menyesuaikan background saat resize
          updateBgImagePositionOnRender();
        }
      });

      document.addEventListener("DOMContentLoaded", () => {
        if (!savedDesign) {
          updateDesignList();
        }
        window.dispatchEvent(new Event("resize"));
        updateUIFromActiveObject();
      });

      // modal pop product design js
      document.addEventListener("DOMContentLoaded", function () {
        const previewButton = document.getElementById("previewButton");
        const previewModal = document.getElementById("previewModal");
        const closeModalButton = document.getElementById("closeModalButton");
        const designPreviewImage =
          document.getElementById("designPreviewImage");

        // Fungsi untuk membuka modal
        previewButton.addEventListener("click", function () {
          // Sembunyikan garis bantu sebelum mengambil gambar
          guideLineX.set("visible", false);
          guideLineY.set("visible", false);
          labelX.set("visible", false);
          labelY.set("visible", false);
          canvas.renderAll(); // Pastikan canvas di-render ulang setelah menyembunyikan garis

          // --- LOGIKA UNTUK MENGAMBIL DESAIN BAJU TERBARU DARI FABRIC.JS CANVAS ---
          const dataURL = canvas.toDataURL({
            format: "png",
            multiplier: 2, // Opsional: tingkatkan resolusi untuk kualitas lebih baik di modal
            // Jika Anda hanya ingin merender area baju yang spesifik (bukan seluruh canvas),
            // Anda bisa menambahkan properti 'left', 'top', 'width', 'height' di sini
            // berdasarkan posisi dan ukuran `bgImageObject`. Contoh:
            // left: bgImageObject.left,
            // top: bgImageObject.top,
            // width: bgImageObject.scaledWidth,
            // height: bgImageObject.scaledHeight,
          });

          designPreviewImage.src = dataURL; // Set src gambar modal dengan data URL dari kanvas

          previewModal.classList.remove("hidden"); // Tampilkan modal
          document.body.classList.add("overflow-hidden"); // Nonaktifkan scroll body
        });

        // Fungsi untuk menutup modal
        closeModalButton.addEventListener("click", function () {
          previewModal.classList.add("hidden"); // Sembunyikan modal
          document.body.classList.remove("overflow-hidden"); // Aktifkan kembali scroll body
        });

        // Menutup modal jika mengklik di luar konten modal (pada overlay)
        previewModal.addEventListener("click", function (event) {
          if (event.target === previewModal) {
            previewModal.classList.add("hidden");
            document.body.classList.remove("overflow-hidden");
          }
        });

        // Menutup modal dengan tombol ESC
        document.addEventListener("keydown", function (event) {
          if (
            event.key === "Escape" &&
            !previewModal.classList.contains("hidden")
          ) {
            previewModal.classList.add("hidden");
            document.body.classList.remove("overflow-hidden");
          }
        });
      });
    </script>
  </body>
</html>
